<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>图文详情</title>

    <!-- build:css css/build_wap_product_detail.min.css -->
    <link type="text/css" rel="stylesheet" href="css/reset.css"/>
    <link type="text/css" rel="stylesheet" href="css/swiper3.1.0.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/mobile-photo-preview.min.css">
    <!-- endbuild -->

    <style type="text/css">
        .picInfoNull{ line-height: 50px; text-align: center; font-size: 14px; color: #999;}
        .goods-main {padding-bottom:10px;}

        .shopDImg_boxPa li{background:url(images/logo-default-pic@3x.png) center center #f2f2f2 no-repeat;background-size:auto 64px;height:100%;float:left;}
        .shopDImg_boxPa li img{ width:100%;min-height:100%;display:block;}

        .goodsPriceN strong{font-size:30px;}

        .goodsFT .goodSale span{display:inline-block;margin-left:12px; margin-right:4px;padding-left:24px;}

        .goodsEvaluate a{background:url(images/ic-more@3x.png) right center no-repeat;display:block;background-size:auto 10px;height:44px;padding:0 12px;}
        .goodsEvaluate .goodScore span.text {color:#ff9e05;font-size:13px;}
        .shopName a{ color:#333; line-height:26px; font-size:16px;overflow:hidden;padding-bottom:3px; text-overflow:ellipsis; white-space:nowrap;display:block;width:100%;}

        .shopOther p{display: inline-block;width:33%;line-height: 40px;color:#ff9e05;text-align: center;height:40px;}
        .shopOther span{font-size: 12px;padding-left:20px;display:inline-block;}
        .parking-sign span{background: url("images/product-parking-sign@2x.png") left 14px no-repeat;background-size: 12px;}
        .wi-fi span{background: url("images/product-wi-fi@2x.png") left 14px no-repeat;background-size: 12px;}
        .credit-card span{background: url("images/product-credit-card@2x.png") left 14px no-repeat;background-size: 12px;}
        .parking-sign2 span{background: url("images/product-parking-sign.png") left 14px no-repeat;background-size: 12px;}
        .wi-fi2 span{background: url("images/product-wi-fi.png") left 14px no-repeat;background-size: 12px;}
        .credit-card2 span{background: url("images/product-credit-card.png") left 14px no-repeat;background-size: 12px;}

        .product-details{ margin-top:10px;border-top:1px solid #efefef;border-bottom:1px solid #efefef; background:#fff;color:#333;font-size:13px;}
        .product-details .title{color:#333;font-size:16px;height:40px;line-height:40px;padding:0 12px; border-bottom: 1px solid #efefef;}
        .order-details{padding:0 12px; color: #666;}
        .order-details li{width:100%;font-size:0;}
        .order-details span{display: inline-block;font-size:14px;text-align: center;width:69px;height:30px;line-height:30px;overflow:hidden;border-right:#fff solid 1px;}
        .order-title {height:32px;color:#333;}
        .order-title span{height:32px;line-height:32px; overflow:hidden;}
        .order-details span.name {width:32%; text-align: left;}
        .order-details span.price {width:22%;}
        .order-details span.size {width:24%;}
        .order-details span.subtotal {width:20%; text-align: right;}
        .product-price {border-top:#efefef solid 1px;height:40px;line-height:40px;font-size:14px;text-align: right;padding:0 12px;}
        .bd-remark-box{ background: #fff; border-bottom:1px solid #efefef; padding: 12px 10px; color: #666;}
        .product-details .priceN{color:#ff0000;}
        .buy-know {padding:12px 14px 4px;}
        .buy-know h2{color:#ffa200;font-size:12px;line-height: 20px;}
        .buy-know p{color:#666;font-size: 12px;line-height:20px;padding-bottom:8px;}

        .product-more-box{ margin-top:10px;}
        .product-more-box .title{ background:#FFF;color:#333;font-size:16px;height:40px;line-height:40px;padding:0 12px; border-top: 1px solid #efefef;}
        .activDetailH{border-top:1px solid #efefef;padding:10px 12px 10px;overflow:hidden;font-size:14px;border-bottom:1px solid #efefef; background:#fff;color:#333;font-size:13px;}
        .activDetailH .activeDetailHTitle{color:#333;font-size:14px; color:#fff;height:30px;line-height:30px; background:#FF4946;margin:10px 0px; padding-left: 10px; border-radius: 4px;}
        .activDetailH img{ display:block; width:100%;height:auto;}
        .activDetailH .more{margin:0 12px;height:44px;line-height:44px;color:#ff9e05;background:url(images/ic-more@3x.png) right center no-repeat;background-size:auto 10px;display:block;font-size:14px;}

        pre {
            white-space: pre-wrap!important;
            word-wrap: break-word!important;
        }
    </style>

</head>

<body>

<div class="goods-main" id="goodsMain"></div>

<script type="text/template" id="goodstmpl">
    <div id="goodsHeight">

        {{if(it.good_info.wap_buy_notes != null){}}
        <div class="product-details">
            <div class="title">购买须知</div>
            <div class="buy-know">
                {{ if(  it.good_info.validate_time!="" && it.good_info.validate_time!=null ) { }}
                <h2>有效期</h2>
                {{ if(  it.good_info.validate_time==0){ }}
                <p><pre>永久有效</pre></p>
                {{ }else{ }}
                <p><pre>{{=get_time(it.good_info.validate_time)}}</pre></p>
                {{ } }}
                {{ } }}

                {{ if(  it.good_info.using_time!="" && it.good_info.using_time!=null ) { }}
                <h2>使用时间</h2>
                <p><pre>{{=it.good_info.using_time}}</pre></p>
                {{ } }}

                {{ if(  it.good_info.wap_buy_notes.appoint_note!="" && it.good_info.wap_buy_notes.appoint_note!=null ) { }}
                <h2>预约信息</h2>
                <p><pre>{{=it.good_info.wap_buy_notes.appoint_note}}</pre></p>
                {{ } }}

                {{ if(  it.good_info.wap_buy_notes.r_remark!="" && it.good_info.wap_buy_notes.r_remark!=null ) { }}
                <h2>温馨提示</h2>
                <p><pre>{{=it.good_info.wap_buy_notes.r_remark}}</pre></p>
                {{ } }}

                {{ if(  it.good_info.try_area!="" && it.good_info.try_area!=null ) { }}
                <h2>适用范围</h2>
                <p><pre>{{=it.good_info.try_area}}</pre></p>
                {{ } }}
            </div>
        </div>
        {{}}}

        {{ if(it.good_info.wap_activity_notes != null  &&  it.good_info.wap_activity_notes.activity_name[0] != ''&& it.good_info.wap_buy_notes != null  &&it.good_info.using_time != null&&it.good_info.activity_notes != null&&it.good_info.wap_buy_notes.appoint_note != null) { }}
        <div class="product-details">
            <div class="title">本单详情</div>
            <ul class="order-details">
                <li class="order-title">
                    <span class="name">名称</span>
                    <span class="price">原价</span>
                    <span class="size">数量/规格</span>
                    <span class="subtotal">小计</span>
                </li>
                {{ for ( var i=0 ; i <  it.good_info.wap_activity_notes.activity_name.length ; i++){ }}
                <li>
                    <span class="name">{{=it.good_info.wap_activity_notes.activity_name[ i]}}</span>
                    <span class="price">￥{{=it.good_info.wap_activity_notes.activity_price[ i]}}</span>
                    <span class="size">{{=it.good_info.wap_activity_notes.activity_spc[ i]}}</span>
                    <span class="subtotal">￥{{=it.good_info.wap_activity_notes.activity_total[ i]}}</span>
                </li>
                {{ } }}
            </ul>
            <div class="product-price">原价：¥{{=parseFloat(it.good_info.goods_marketprice)}} &nbsp;&nbsp;爱个购价：<span class="priceN">¥{{=parseFloat(it.good_info.goods_price)}}</span></div>
        </div>

        {{ if(  it.good_info.package_note!="" && it.good_info.package_note!=null ) { }}
        <div class="bd-remark-box"><pre>{{=it.good_info.package_note}}</pre></div>
        {{ } }}

        {{ } }}
    </div>
    <div id="goodsMore">
        <div class="product-more-box">
            <div class="title">图文详情</div>
            <div class="activDetailH">
                {{ if(  it.good_info.mobile_body!="" && it.good_info.mobile_body!=null ) { }}
                {{=it.good_info.mobile_body}}
                {{ }else{ }}
                <div class="picInfoNull">暂无图文信息~</div>
                {{ } }}
            </div>
        </div>
    </div>

</script>

<!-- build:inlinejs -->
<script type="text/javascript" src="js/config.js"></script>
<!-- endbuild -->

<!-- build:js js/build_wap_product_detail.min.js -->
<script type="text/javascript" src="js/lib/zepto.min.js"></script>
<script type="text/javascript" src="js/lib/doT.min.js"></script>
<script type="text/javascript" src="js/lib/dialog.min.js"></script>
<script type="text/javascript" src="js/lib/mobile-photo-preview.min.js"></script>
<script type="text/javascript" src="js/lib/swipe.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<!-- endbuild -->

<script type="text/javascript">
    $(function() {
        var x=$(window).width();
        var lat=localStorage.getItem("latitude");
        var lng=localStorage.getItem("longitude");
        var thisGoodID=request("good_id");
        var key=getcookie('key');

        $.ajax({
            url:ApiUrl+"/index.php?act=unlimited_invitation&op=good_detail&client_type=wap&good_id="+thisGoodID+"&lat="+lat+"&lng="+lng+"&callback=callback",
            type:"get",
            dataType:"jsonp",
            jsonp:"callback",
            success:function(result){
                if(result.code==200){
                    var goodsDoTmpl = doT.template($("#goodstmpl").html());
                    $("#goodsMain").show().html(goodsDoTmpl(result.data));
                    var thisInvitation=result.data.store_info.invitation;
                    var moneyBTCon=result.data.good_info.goods_price;
                    var storeTelPhone=result.data.store_info.store_phone;

                    //懒加载
                    echo.init({
                        offset: 10,
                        throttle: 100,
                        unload: false,
                        callback: function (element, op) {
                            //console.log(element, 'has been', op + 'ed')
                        }
                    });

                    $(".h-r-text").width($(window).width()-120);

                    $(window).resize(function(){
                        var wHeight=$(window).height();
                        var mdmHeight=200;
                        $(".mdmPayLayBox").css("margin-top",(wHeight-mdmHeight)/2);
                    });

                }
            }
        });

    });

    function get_time(this_time){
        Date.prototype.format = function(format) {
            var date = {
                "M+": this.getMonth() + 1,
                "d+": this.getDate(),
                "h+": this.getHours(),
                "m+": this.getMinutes(),
                "s+": this.getSeconds(),
                "q+": Math.floor((this.getMonth() + 3) / 3),
                "S+": this.getMilliseconds()
            };
            if (/(y+)/i.test(format)) {
                format = format.replace(RegExp.$1, (this.getFullYear() + '').substr(4 - RegExp.$1.length));
            }
            for (var k in date) {
                if (new RegExp("(" + k + ")").test(format)) {
                    format = format.replace(RegExp.$1, RegExp.$1.length == 1
                            ? date[k] : ("00" + date[k]).substr(("" + date[k]).length));
                }
            }
            return format;
        }
        var cc=new Date(parseInt(this_time)*1000);
        var aa=cc.format('yyyy-MM-dd hh:mm:ss');
        return aa;
    }
</script>


</body>
</html>
